<!DOCTYPE html>
<head></head>
<body>
  
</body>

<script>
let flag = false
var numIslands = function(grid) {
  let copyArr = [];
  for(let i = 0; i < grid.length; i++){
    let [...arr] = grid[i]
    copyArr.push(arr)
  }
  let total = 0
  const gridLen = grid.length
  grid.map((item, index) => {
    const subLen = item.length
    item.map((subItem, subIndex) => {
      let top = ''
      let right = ''
      let bottom = ''
      let left = ''
      if (index === 0) {
        if (subIndex === 0) {
          top = 0
          right = item[subIndex + 1]
          bottom = grid[index + 1][0]
          left = 0
        } else if (subIndex === subLen - 1) {
          top = 0
          right = 0
          bottom = grid[index + 1][subLen - 1]
          left = item[subIndex - 1]
        } else {
          top = 0
          right = item[subIndex + 1]
          bottom = grid[index + 1][subLen - 1]
          left = item[subIndex - 1]
        }
      } else if (index === gridLen - 1) {
        if (subIndex === 0) {
          top = grid[index - 1][0]
          right = item[subIndex + 1]
          bottom = 0
          left = 0
        } else if (subIndex === subLen - 1) {
          top = grid[index - 1][0]
          right = 0
          bottom = 0
          left = item[subIndex - 1]
        } else {
          top = grid[index - 1][0]
          right = item[subIndex + 1]
          bottom = 0
          left = item[subIndex - 1]
        }
      } else {
        if (subIndex === 0) {
          top = grid[index - 1][0]
          right = item[subIndex + 1]
          bottom = grid[index + 1][0]
          left = 0
        } else if (subIndex === subLen - 1) {
          top = grid[index - 1][0]
          right = 0
          bottom = grid[index + 1][0]
          left = item[subIndex - 1]
        } else {
          top = grid[index - 1][0]
          right = item[subIndex + 1]
          bottom = grid[index + 1][0]
          left = item[subIndex - 1]
        }
      }
      const reset = needSet(subItem, top, right, bottom, left)
      if (reset) {
        copyArr[index][subIndex] = '0'
      }
      if (subItem === '1' && index !== gridLen - 1 && grid[index + 1][subIndex] === '1') {
        copyArr[index + 1][subIndex] = '0'
      }
    })
  })
  console.log(grid)
  console.log(copyArr)
  copyArr.map(item => {
    total += item.filter(subItem => subItem === '1').length
  })
  return total
};
function needSet(current, top, right, bottom, left) {
  const checkArr = [top, right, bottom, left]
  if (current === '1' && flag) {
    return checkArr.findIndex(item => item === '1') >= 0
  } else if (current === '1' && !flag) {
    flag = true
    return false
  } else if (current === '0') {
    flag = false
    return false
  }
}

console.log(numIslands([["0","1","0","1","0"],["1","1","0","1","0"],["1","1","0","0","0"],["0","0","0","0","0"]]))

// 01010
// 11010
// 11000
// 00000
// 2

// [["0","1","0","1","0"],["0", "0", "1", "0", "1"],["1", "1", "0", "1", "1",["0","0","0","0","0"]]
// 01010
// 00101
// 11011
// 00000
// 5

// 11000
// 11000
// 00100
// 00011
// 3

// 11111
// 11111
// 11111
// 11111
// 1


</script>
